# NCAA Next Dynasty Tracker

A browser-based tracker for **NCAA Next** dynasties. Create multiple dynasties, import one or more seasons from game-exported CSVs, then explore schedules/results, teams, team stats, postseason, and conference standings.

All dynasty data is stored **locally** (IndexedDB via Dexie). There is no backend and no account system.

## Contents
- Quick start
- Requirements
- Core concepts
- Creating a dynasty
- Uploading a season (CSV import)
- Loading/switching dynasties
- Navigating the UI
- CSV requirements (important)
- Logos (optional)
- Pitfalls & troubleshooting
- Development / deployment notes

## Quick start
### Web App (GitHub Pages)
1. Open the app in a modern browser.
2. Click **+ New Dynasty**, give it a name, and set a **Starting Year**.
3. When prompted (or from the sidebar), click **+ Upload New Season**.
4. Choose a **Season Year** and select the required CSVs (see CSV requirements below).
5. After import completes, use the left sidebar to navigate.

### Desktop App (portable offline Windows app)
1. Download the latest Desktop App zip release and extract it to a folder (USB is fine).
2. Run `Dynasty Tracker.exe`.
3. Click **+ New Dynasty** (or **Load Backup** if you already have data).
4. Click **+ Upload New Season** and import your season CSVs.
5. Your data is stored in a `data/` folder next to the `.exe` and persists across restarts and upgrades.

## Requirements

### Web App (normal use)
- A modern browser with:
  - IndexedDB support (Chrome/Edge/Firefox/Safari)
  - File upload support
  - `crypto.randomUUID()` support (used for dynasty IDs)
- Enough local storage space (large dynasties can be sizable).

### Web App (best reliability)
- Use a normal browser window (avoid Incognito/Private mode).
- If your browser prompts about site storage, allow persistent storage (the app requests it on startup).

### Desktop App (portable offline)
The Desktop App is a **portable Windows desktop app** (Electron). It is strictly offline and stores all data next to the executable so you can run it from a USB drive.

Key behavior:
- Storage is **not tied to a browser profile**. Clearing browser site data will not affect the desktop app.
- All Dexie/IndexedDB data lives in a `data/` folder next to the app `.exe`.
- The app runs a local loopback server (`http://127.0.0.1:5174`) internally (offline; no external network calls required).

Portability (moving saves between Windows devices):
- **Copy the app folder** (including the `data/` folder) to the new machine/USB location. As long as `data/` stays next to the `.exe`, your dynasties move with it.
- Or use **Import / Export**: export a backup file on one machine, then import it on the other (works for both the Web App and Desktop App).

Upgrading the portable app:
1. Download the new zip release.
2. Extract it over your existing app folder.
3. **Do not delete the `data/` folder**. Keeping `data/` preserves all dynasties and seasons.

### For local development
- Node.js + npm
- Install deps: `npm install`
- Run dev server: `npm run dev` (defaults to `http://127.0.0.1:5173`)
- Build: `npm run build`
- Preview build: `npm run preview`
- Desktop build: `npm run build:electron`
- Desktop package (Windows zip): `npm run package:electron`

## Core concepts

### Dynasty
A dynasty is a separate "save slot" inside the app. Each dynasty has its own:
- Imported seasons
- Teams, schedules, and games
- Team stats
- Bowl metadata
- Resolved team logos (and future per-team overrides)

### Season
Each import is stored under a specific season year (e.g., 2026). You can import multiple seasons per dynasty, and you can overwrite a season year (with confirmation).

### Where your data lives
Data is stored in IndexedDB under the database name:
- `dynasty-tracker-v1`

### Web App
If you clear Site Data/Storage for the website, you will delete your dynasties in the browser version.

### Desktop App
Data is stored in `data/` next to the executable. Deleting `data/` deletes your dynasties.

## Creating a dynasty
### Web App
1. In the left sidebar under **Dynasties**, click **+ New Dynasty**.
2. Enter:
  - **Dynasty Name** (required)
  - **Starting Year** (required, numeric)
3. Click **Create Dynasty**.

Notes:
- If this is your **first** dynasty, the app immediately prompts you to upload your first season.
- For additional dynasties, the app creates it and then loads it as the active dynasty.
- If you already have data, use **Import / Export** to load a backup. On first launch (no dynasties), the Create New Dynasty modal also includes a **Load Backup** button.

### Desktop App
Same flow as the Web App. If you are migrating from the Web App, use **Import / Export** to import your backup file into the Desktop App.

## Uploading a season (CSV import)

### Web App (from the UI)
1. Select the dynasty you want to import into (it must be **Active**).
2. In the left sidebar under **Dynasties**, click **+ Upload New Season**.
3. Set **Season Year** (defaults to the dynasty's current-year suggestion).
4. Choose one import method:
   - **Choose Files**: pick the required CSV files directly, or
   - **Choose Folder** (single season): pick a folder containing the season CSVs
5. Click **Import Season**.
6. When the status reads something like `Imported 2026: 134 teams, 900 games`, the app returns you to the main views.

### Desktop App (from the UI)
Same flow as the Web App. The Desktop App is offline, so you must import from local files/folders.

### Getting the required CSVs (recommended)
The easiest way to export the required CSVs is with Antdroid's NCAA DB Editor:
- https://github.com/antdroidx/NCAA-DB-Editor

Important dynasty timing:
- Do **not** advance your dynasty past the National Championship game before exporting.
- At the National Championship point, **close PCSX2 completely**, load the dynasty file in the DB Editor, and export the CSVs.
- After exporting, you can resume your dynasty in PCSX2 normally.

Export options in the DB Editor:
- **Export All**: exports a full set of CSVs (safe fallback if you're missing a required file).
- **Export to Dynasty Tracker**: exports only the Dynasty Tracker CSVs, but it may lag behind if new required files are added. If an import fails due to a missing CSV type, use **Export All** instead.

Folder organization tip:
- Keep each season's exported CSVs in its own folder named by season year (e.g., `2030/`) as a backup.
- The DB Editor will do this season-folder layout automatically when using **Export to Dynasty Tracker**.

### Bulk seasons (folder import)
In the Import Season modal, switch to **Bulk Seasons** to select a parent folder that contains year folders (e.g., `2025/`, `2026/`). The app will detect seasons from folder paths and import them in order.

### Overwriting an existing season year
If you import a year that already exists in the active dynasty:
- The import button becomes **Overwrite Season**
- You will see an overwrite warning
- You must confirm overwrite in a modal

Important:
- Overwrite **deletes and replaces** all stored records for that dynasty + season year (TEAM/SCHD/TSSE/BOWL-derived records).
- This cannot be undone inside the app.

## Loading / switching dynasties
In the left sidebar under **Dynasties**:
- The active dynasty shows an **Active** badge.
- Clicking a *non-active* dynasty opens **Dynasty Options**:
  - **Load**: switches to that dynasty and reloads the app so all views use it
  - **Delete**: permanently deletes the dynasty and all of its data

Tip:
- If you only have one dynasty, clicking the active dynasty name opens options for that dynasty.

## Deleting a dynasty (permanent)
1. Open **Dynasty Options** (click the dynasty name).
2. Click **Delete**.
3. Confirm in **Confirm Delete**.

This deletes:
- The dynasty record itself
- All seasons, teams, games, stats, and bowl rows associated with it

## Navigating the UI
The app layout is:
- **Left sidebar**: navigation + dynasty management
- **Main content card**: the page you are currently viewing

### Sidebar navigation
The **Navigation** section contains:
- **Schedule / Results**: season + week filters, click teams to open their pages
- **Teams**: a conference grid of teams (click any team)
- **Team Stats**: sortable team stat tables (TSSE-based)
- **Postseason**: conference championships, bowls, and playoff bracket
- **Conference Standings**: standings by conference (or all conferences)

### Schedule / Results (Home)
What you can do:
- Pick a **Season** (dropdown)
- Filter by **Week** (All or a specific week)
- Click a team row (home or away) to open its **Team** page

What you will see:
- Week number
- Home and away teams (with logos when available)
- Result (score) when available from `SCHD.csv`

If it says "No seasons uploaded":
- Upload a season for the active dynasty using **+ Upload New Season**.

### Teams
What you can do:
- Browse teams grouped by conference
- Click any team to open its **Team** page

Notes:
- This view is built from the dynasty's team season snapshot (typically the most recently imported season).
- If it says "No teams found yet", import a season first.

### Team page
What you can do:
- Switch between **All seasons** and a **specific season year**
- Review the team's schedule/results
- Click opponents to jump between team pages

What you will see:
- Opponent rows with `vs` (home) or `@` (away)
- A W/L badge when scores exist
- Bowl metadata when a game is mapped to a bowl
- Prestige stars (from `TEAM.csv` column `TMPR`, using the latest season snapshot)

### Team Stats
Team Stats comes from `TSSE.csv` and adds a few derived metrics.

What you can do:
- Select a **Season** year
- Switch tabs: **Offense**, **Defense**, **Efficiency**
- Sort by clicking column headers
- Click a team to open its **Team** page

If it says "No Team Stats imported yet":
- Re-import a season and make sure `TSSE.csv` is included and contains a `TGID` column.

### Postseason
What you can do:
- Select a **Season**
- Switch between tabs:
  - **Conference Championships**
  - **Bowls**
  - **Bracket** (College Football Playoff)
- Click a bowl name to open its **Bowl Results** page
- Click teams to open **Team** pages

Notes:
- Postseason views require bowl mapping info from `BOWL.csv` (`BNME`) and schedule game staging from `SCHD.csv` (`SEWN`, `SGNM`).
- The bracket is derived from CFP-labeled bowl names and specific postseason weeks.

### Bowl Results
This page shows all games for a specific bowl name across imported seasons.

How to use:
- Navigate here by clicking a bowl name in the **Postseason** table.
- Click teams to open their **Team** pages.

### Conference Standings
What you can do:
- Select a **Season**
- Select a **Conference**
  - `All` shows a standings card for each conference
  - A specific conference shows one standings table
- Click teams to open **Team** pages

Standings include:
- Overall record (W-L[-T])
- Conference record (W-L[-T])
- Points For / Points Against / Point Differential

## CSV requirements (important)

The import step detects file types **by filename**. Make sure your files are named exactly like this (case-insensitive is fine):
- `TEAM.csv`
- `SCHD.csv`
  - `TSSE.csv`
  - `BOWL.csv`
  - `COCH.csv`
  - `PRLU.csv`
  - `PLAY.csv`
  - `PSOF.csv`
  - `PSDE.csv`
  - `PSKI.csv`
  - `PSKP.csv`
  - `AAPL.csv`
  - `OSPA.csv`

The importer reads the last 4 alphanumeric characters before `.csv` as the type code, so names like `my-export-TEAM.csv` also work as long as they still end in `TEAM.csv`.

### Data consistency rules (common causes of "missing" data)
- `TGID` values should match across `TEAM.csv`, `SCHD.csv`, and `TSSE.csv`.
- Bowl mapping relies on (`seasonYear`, `SEWN`, `SGNM`) matching between `SCHD.csv` and `BOWL.csv`.
- CSVs must include a header row and not be empty.

## Logos (optional but recommended)
The app supports:
- Team logos (mapped automatically after import)
- Conference logos (shown in Teams + Conference Standings)
- Postseason/bowl logos (shown in Postseason and Bowl Results)

Logo sources live under `public/logos/` and are registered by `public/logos/index.json`.

Notes:
- If a logo URL is a GitHub "blob" URL, the app converts it to a `raw.githubusercontent.com` URL automatically.
- If a logo fails to load, the UI falls back to a default placeholder.
- If you are offline or a logo host blocks hotlinking, you may see the fallback logo.

See `docs/LOGOS.md` for the expected `public/logos/index.json` format.

## Pitfalls & troubleshooting

### "My data disappeared"
Most common causes:
- Web App: You opened the app in Incognito/Private mode (storage may be cleared automatically).
- Web App: You cleared the site's storage/cache.
- Web App: A browser/OS "storage pressure" cleanup removed non-persisted storage.
- Desktop App: The `data/` folder next to the `.exe` was deleted or the app was moved without that `data/` folder.

What to do:
- Web App: Use a normal browser profile.
- Web App: If prompted, allow persistent storage.
- Web App: Avoid clearing site data if you want to keep dynasties.
- Desktop App: Make sure the `data/` folder stays next to the `.exe` when moving the app (e.g., on a USB drive).

### Optimize Database (use only if needed)
The **Optimize Database** action rebuilds/compacts the local IndexedDB data to reduce fragmentation and improve performance.

Notes:
- Only use this if you're experiencing severe performance or storage issues.
- It can take a while on large dynasties, and it may fail if another app window is open (close other tabs/windows first).
- If you want extra safety, export a backup first via **Import / Export**.

### Import fails with "Missing required CSV(s)"
- You did not select all four required files.
- One or more filenames do not end with `TEAM.csv`, `SCHD.csv`, `TSSE.csv`, `BOWL.csv`.

### Import fails with "missing required columns"
- Your export does not match the required headers listed above.
- Headers are case-sensitive for the required list (e.g., it expects `TGID`, not `tgid`).

### "No teams found" / "No stats found" after import
- Ensure the import finished successfully (check the status message).
- Verify that your CSVs are not empty and have correct headers.
- Verify IDs are consistent across files (`TGID` matches).

### Overwrite surprises
Overwrite is intentionally destructive (season-year scoped). If you want to compare two versions of the same year, import one of them under a different season year.

## Privacy
- No accounts.
- No server-side storage.
- Your imported data stays in your browser unless you delete it.

